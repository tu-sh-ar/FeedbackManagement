paths:
  /api/feedbackTemplate/getDefaultBusinessCategoryTemplates/{businessCategoryId}:
    get:
      summary: Fetches default templates based on businessCategoryId
      tags:
        - Feedback Template
      parameters:
        - in: path
          name: businessCategoryId
          required: true
          schema:
            type: integer
            example: 1
          description: ID of the business category
      responses:
        200:
          description: Successful response with the templates segregated by FeedbackCategory
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TemplateResponse'
              examples:
                DefaultTemplateExample:
                  value:
                    - templates:
                      - id: "64b161d57d75d86fd1af82d4"
                        templateName: "Default Template 1"
                        businessCategory: 1
                        sections:
                          - id: 1
                            title: "Product"
                            order: 1
                            questions:
                              - id: 1
                                question: "How satisfied were you with the product? (Rating)"
                                answerFormat:
                                  type: "rating"
                                  required: false
                                  upperBound: 5
                                order: 1
                              - id: 2
                                question: "Please update photo/video of the product"
                                answerFormat:
                                  type: "file"
                                  required: true
                                order: 2
                            isActive: true
                          - id: 2
                            title: "Packaging"
                            order: 2
                            questions:
                              - id: 4
                                question: "How satisfied were you with the quality of the packaging materials used for your order? (Rating)"
                                answerFormat:
                                  type: "rating"
                                  required: false
                                  upperBound: 5
                                order: 1
                              - id: 5
                                question: "Did the packaging adequately protect the contents of your package?"
                                answerFormat:
                                  type: "radio"
                                  options:
                                    - "Yes"
                                    - "No"
                                  required: true
                                order: 2
                            isActive: true
                          - id: 3
                            title: "Overall Satisfaction"
                            order: 3
                            questions:
                              - id: 9
                                question: "Would you recommend the Product to others based on your experience?"
                                answerFormat:
                                  type: "radio"
                                  options:
                                    - "Yes"
                                    - "Maybe"
                                    - "No"
                                  required: true
                                order: 1
                            isActive: true
                        isActive: true
                      feedbackType:
                        id: "64b14fe37d75d86fd1af82c1"
                        name: "Product Feedback from Customers"
  /api/feedbackTemplate/getBusinessAdminTemplates/{businessCategory}:
    get:
      summary: Fetches templates based on businessAdminId
      tags:
        - Feedback Template     
      security:
        - JWTAuth: []
      parameters:
        - in: path
          name: businessCategory
          required: true
          schema:
            type: integer
            example: 1
          description: ID of the business category
      responses:
        200:
          description: Successful response with the templates segregated by FeedbackCategory
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ShortTemplateResponse'
              examples:
                TemplateExample:
                  value:
                    - templates:
                      - id: "64b161d57d75d86fd1af82d4"
                        templateName: "Default Template 1"
                        businessCategory: 1
                        isActive: true
                      feedbackType:
                        id: "64b14fe37d75d86fd1af82c1"
                        name: "Product Feedback from Customers"
  /api/feedbackTemplate/create:
    post:
      summary: Create a new default/custom feedback form template
      description: Use admin account/token for creating default template and business admin account/token for default template
      tags:
        - Feedback Template
      security:
        - JWTAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FeedbackFormBodySchema'
            example:
              businessCategory: 1
              feedbackType: 64b14fe37d75d86fd1af82c1
              feedbackFormName: E-commerce feedbacks
              sections:
                - title: product
                  order: 1
                  questions:
                    - question: How was the quality of product?
                      answerFormat:
                          type: boolean
                          required: true
                      order: 1
                    - question: Was there any defects in product?
                      answerFormat:
                          type: radio
                          options:
                            - options1
                            - options2
                            - options3
                          required: true
                      order: 2
                - title: packaging
                  order: 2
                  questions:
                    - question: How was the packaging of the product?
                      answerFormat:
                          type: rating
                          upperBound: 10
                          required: false
                      order: 1
                - title: delivery
                  order: 3
                  questions:
                    - question: Was the delivery on-time?
                      answerFormat:
                          type: boolean
                          required: false
                      order: 1
      responses:
        '200':
          description: Feedback form created successfully
        '400':
          description: Invalid request body
  /api/feedbackTemplate/update/{templateId}:
    put:
      summary: Update Feedback Template
      tags:
        - Feedback Template
      description:
        This API updates an existing feedback template if it has not been used before.
        The template is identified by the templateId parameter.

        If the user is an admin, the default template will be updated.
        If the user is a business admin, the custom template will be updated.
      parameters:
        - in: path
          name: templateId
          schema:
            type: string
          example: 64b18a0be9a93aebfa3581ae
          required: true
          description: The ID of the feedback template to be updated
      security:
        - JWTAuth: []
      requestBody:
        name: templateData
        required: true
        description: The updated template data
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FeedbackFormBodySchema'
            example:
              businessCategory: 1
              feedbackType: 64b14fe37d75d86fd1af82c1
              businessAdminId: 1
              feedbackFormName: E-commerce feedbacks
              sections:
                - title: product
                  order: 1
                  fields:
                    - question: How was the quality of product?
                      answerFormat:
                          type: boolean
                          required: true
                      order: 1
                    - question: Was there any defects in product?
                      answerFormat:
                          type: radio
                          options:
                            - options1
                            - options2
                            - options3
                          required: true
                      order: 2
                - title: packaging
                  order: 2
                  fields:
                    - question: How was the packaging of the product?
                      answerFormat:
                          type: starrating
                          upperBound: 10
                          required: false
                      order: 1
                - title: delivery
                  order: 3
                  fields:
                    - question: Was the delivery on-time?
                      answerFormat:
                          type: boolean
                          required: false
                      order: 1
      responses:
        '200':
          description: Feedback form updated successfully
        '400':
          description: Bad Request
        '404':
          description: Template not found
        '500':
          description: Internal Server Error
  /api/feedbackTemplate/swapQuestion/{templateId}/{sectionId}:
    put:
      summary: Swap Question Order in Template
      tags:
        - Feedback Template
      description: |
        This API allows swapping the order of questions within a specific section of a feedback template.

        The template is identified by the templateId parameter, and the section is identified by the sectionId parameter.
      parameters:
        - in: path
          name: templateId
          schema:
            type: string
          required: true
          description: The ID of the feedback template
        - in: path
          name: sectionId
          schema:
            type: string
          required: true
          description: The ID of the section within the template
      security:
        - JWTAuth: []
      requestBody:
        name: QuestionOrder
        required: true
        description: The request body containing the question IDs to swap
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SwapQuestionOrderRequest'
      responses:
        '200':
          description: Question order swapped successfully
        '400':
          description: Bad Request
        '404':
          description: Template, section, or question not found
        '500':
          description: Internal Server Error
  /api/feedbackTemplate/swapSections/{templateId}:
    put:
      summary: Swap Section Order in Template
      description: |
        This API allows swapping the order of sections within a feedback template.

        The template is identified by the templateId parameter, and the sections are identified by sectionId1 and sectionId2 in the request body.
      parameters:
        - in: path
          name: templateId
          schema:
            type: string
          required: true
          description: The ID of the feedback template
      tags:
        - Feedback Template      
      security:
        - JWTAuth: []
      requestBody:
          name: SectionOrder
          required: true
          description: The request body containing the section IDs to swap
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SwapSectionOrderRequest'
      responses:
        '200':
          description: Section order swapped successfully
        '400':
          description: Bad Request
        '404':
          description: Template or section not found
        '500':
          description: Internal Server Error
  /api/feedbackTemplate/getTemplateById/{templateId}:
    get:
      summary: Fetch Template by ID with Sorted Questions and Sections
      description: |
        This API retrieves a single feedback template based on the templateId parameter. The questions and sections within the template are sorted according to their order.

        The templateId parameter should be a valid integer representing the ID of the template to fetch.
      parameters:
        - in: path
          name: templateId
          schema:
            type: string
          required: true
          description: The ID of the feedback template to fetch
      tags:
        - Feedback Template      
      security:
        - JWTAuth: []
      responses:
        '200':
          description: Template retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TemplateResponse'
              examples:
                TemplateExample:
                  value:
                    templatesByCategory:
                      Product Feedback from Customers:
                        - id: "64b161d57d75d86fd1af82d4"
                          templateName: "Default Template 1"
                          businessCategory: 1
                          sections:
                            - id: 1
                              title: "Product"
                              order: 1
                              questions:
                                - id: 1
                                  question: "How satisfied were you with the product? (Rating)"
                                  answerFormat:
                                    type: "rating"
                                    required: false
                                    upperBound: 5
                                  order: 1
                                - id: 2
                                  question: "Please update photo/video of the product"
                                  answerFormat:
                                    type: "file"
                                    required: true
                                  order: 2
                              isActive: true
                            - id: 2
                              title: "Packaging"
                              order: 2
                              questions:
                                - id: 4
                                  question: "How satisfied were you with the quality of the packaging materials used for your order? (Rating)"
                                  answerFormat:
                                    type: "rating"
                                    required: false
                                    upperBound: 5
                                  order: 1
                                - id: 5
                                  question: "Did the packaging adequately protect the contents of your package?"
                                  answerFormat:
                                    type: "radio"
                                    options:
                                      - "Yes"
                                      - "No"
                                    required: true
                                  order: 2
                              isActive: true
                            - id: 3
                              title: "Overall Satisfaction"
                              order: 3
                              questions:
                                - id: 9
                                  question: "Would you recommend the Product to others based on your experience?"
                                  answerFormat:
                                    type: "radio"
                                    options:
                                      - "Yes"
                                      - "Maybe"
                                      - "No"
                                    required: true
                                  order: 1
                              isActive: true
                          isActive: true
                          feedbackType:
                            id: "64b14fe37d75d86fd1af82c1"
                            name: "Product Feedback from Customers"
        '400':
          description: Bad Request
        '404':
          description: Template not found
        '500':
          description: Internal Server Error
  /api/feedbackTemplate/activateTemplate/{businessAdminId}:
    put:
      summary: Activate Template
      tags:
        - Feedback Template      
      security:
        - JWTAuth: []
      description: Activates a template for use, deactivating other active templates for the same business admin and feedback type
      parameters:
        - name: businessAdminId
          in: path
          description: ID of the business admin
          required: true
          type: integer
      requestBody:
          description: Request body
          required: true
          schema:
            type: object
            properties:
              feedbackType:
                type: string
                description: ID of the feedback type
                required: true
              templateId:
                type: string
                description: ID of the template to activate
                required: true
      responses:
        200:
          description: Template activated successfully
        400:
          description: Invalid businessAdminId or feedbackType format
        500:
          description: Internal Server Error
  /api/feedbackTemplate/deleteTemplate/{templateId}:
    delete:
      summary: Delete Template
      tags:
        - Feedback Template      
      security:
        - JWTAuth: []
      description: Deletes a template if it is not in use
      parameters:
        - name: templateId
          in: path
          description: ID of the template to delete
          required: true
          type: string
      responses:
        200:
          description: Template deleted successfully
        400:
          description: Invalid templateId format or template in use
        404:
          description: Template not found
        500:
          description: Internal Server Error
components:
  schemas:
    SwapSectionOrderRequest:
      type: object
      properties:
        sectionId1:
          type: number
          description: The ID of the first section to swap
        sectionId2:
          type: number
          description: The ID of the second section to swap
      required:
        - sectionId1
        - sectionId2
    SwapQuestionOrderRequest:
      type: object
      properties:
        questionId1:
          type: number
          description: The ID of the first question to swap
        questionId2:
          type: number
          description: The ID of the second question to swap
      required:
        - questionId1
        - questionId2
    ShortTemplateResponse:
      type: object
      properties:
        templatesByCategory:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ShortTemplate'
    ShortTemplate:
      type: object
      properties:
        id:
          type: string
          description: The ID of the template
        templateName:
          type: string
          description: The name of the template
        isActive:
          type: boolean
          description: Indicates whether the template is active
        feedbackType:
          $ref: '#/components/schemas/FeedbackType'
    TemplateResponse:
      type: object
      properties:
        templatesByCategory:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/Template'
    Template:
      type: object
      properties:
        id:
          type: string
          description: The ID of the template
        templateName:
          type: string
          description: The name of the template
        businessCategory:
          type: number
          description: The ID of the business category
        sections:
          type: array
          items:
            $ref: '#/components/schemas/Section'
        isActive:
          type: boolean
          description: Indicates whether the template is active
        feedbackType:
          $ref: '#/components/schemas/FeedbackType'
    Section:
      type: object
      properties:
        id:
          type: number
          description: The ID of the section
        title:
          type: string
          description: The title of the section
        order:
          type: number
          description: The order of the section
        questions:
          type: array
          items:
            $ref: '#/components/schemas/Question'
    Question:
      type: object
      properties:
        id:
          type: number
          description: The ID of the question
        question:
          type: string
          description: The question text
        answerFormat:
          $ref: '#/components/schemas/AnswerFormat'
        order:
          type: number
          description: The order of the question
    FeedbackType:
      type: object
      properties:
        id:
          type: string
          description: The ID of the feedback type
        name:
          type: string
          description: The name of the feedback type
    AnswerFormat:
      type: object
      properties:
        type:
          type: string
          enum:
            - boolean
            - text
            - radio
            - select
            - multiselect
            - checkbox
            - starrating
            - numberrating
            - emojirating
          description: Type of the answer format
        required:
          type: boolean
          description: Whether the answer format is required
        options:
          type: array
          items:
            type: string
          description: List of options for select, multiselect, radio, and checkbox types
        upperBound:
          type: number
          description: Upper bound for starrating, numberrating, and emojirating types
      required:
        - type
        - required
    QuestionAnswerFormField:
      type: object
      properties:
        id:
          type: number
          description: Unique identifier for the field
        question:
          type: string
          description: Question for the field
        order:
          type: number
          description: Order of the field
        answerFormat:
          type: object
          items:
            $ref: '#/components/schemas/AnswerFormat'
          description: List of answer formats for the field
      required:
        - id
        - question
        - order
        - answerFormat
    FeedbackFormat:
      type: object
      properties:
        id:
          type: number
          description: Unique identifier for the format
        title:
          type: string
          description: Title of the format
        order:
          type: number
          description: Order of the format
        fields:
          type: array
          items:
            $ref: '#/components/schemas/QuestionAnswerFormField'
          description: List of fields in the format
      required:
        - id
        - title
        - order
    FeedbackFormBodySchema:
      type: object
      properties:
        businessAdminId:
          type: number;
          description: Business admin id
        businessCategory:
          type: number
          description: Business category
        feedbackType:
          type: string
          description: Feedback type
        feedbackFormName:
          type: string
          description: Name of the feedback form
        sections:
          type: array
          items:
            $ref: '#/components/schemas/FeedbackFormat'
          description: List of feedback sections
      required:
        - feedbackType
        - feedbackFormName
        - sections
    FeedbackQuestion:
      type: object
      properties:
        question:
          type: string
        answerFormat:
          type: string
          enum:
            - enum_value_1
            - enum_value_2
            - enum_value_3
          description: Enum values for answer format
      required:
        - question
        - answerFormat
    FeedbackTemplate:
      type: object
      properties:
        template_type:
          type: string
          enum:
            - enum_value_1
            - enum_value_2
            - enum_value_3
          description: Enum values for template type
        business_type:
          type: string
          enum:
            - enum_value_1
            - enum_value_2
            - enum_value_3
          description: Enum values for business type
        requiredFields:
          type: object
          additionalProperties:
            type: boolean
        qas:
          type: array
          items:
            $ref: '#/components/schemas/FeedbackQuestion'
        client_id:
          type: number
        isActive:
          type: boolean
      required:
        - type
        - businesstype
        - requiredFields
        - qas
        - client_id
        - isActive
      example:
        _id: 617f814ef139c17f53e4e1c4
        template_type: "1"
        business_type: "1"
        requiredFields:
          rating: true
          comment: false
        qas:
          Q1:
            question: "What do you think about the quality of the product?"
            answerFormat: "1"
          Q2:
            question: "How was your experience with the delivery of the product?"
            answerFormat: "3"
          Q3:
            question: "Would you recommend our product to others ?"
            answerFormat: "2"
        isActive: true
        clientId: d1bb78ca-d9e1-4f72-b4d7-677e8ecb3172
        createdAt: '2022-05-11T10:35:20.543Z'
        updatedAt: '2022-05-11T10:35:20.543Z'
  securitySchemes:
    JWTAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  examples:
    DefaultTemplateExample:
      value:
        - id: "64b161d57d75d86fd1af82d4"
          templateName: "Default Template 1"
          businessCategory: 1
          sections:
            - id: 1
              title: "Product"
              order: 1
              questions:
                - id: 1
                  question: "How satisfied were you with the product? (Rating)"
                  answerFormat:
                    type: "rating"
                    required: false
                    upperBound: 5
                  order: 1
                - id: 2
                  question: "Please update photo/video of the product"
                  answerFormat:
                    type: "file"
                    required: true
                  order: 2
              isActive: true
            - id: 2
              title: "Packaging"
              order: 2
              questions:
                - id: 4
                  question: "How satisfied were you with the quality of the packaging materials used for your order? (Rating)"
                  answerFormat:
                    type: "rating"
                    required: false
                    upperBound: 5
                  order: 1
                - id: 5
                  question: "Did the packaging adequately protect the contents of your package?"
                  answerFormat:
                    type: "radio"
                    options:
                      - "Yes"
                      - "No"
                    required: true
                  order: 2
              isActive: true
            - id: 3
              title: "Overall Satisfaction"
              order: 3
              questions:
                - id: 9
                  question: "Would you recommend the Product to others based on your experience?"
                  answerFormat:
                    type: "radio"
                    options:
                      - "Yes"
                      - "Maybe"
                      - "No"
                    required: true
                  order: 1
          isActive: true
          feedbackType:
            id: "64b14fe37d75d86fd1af82c1"
            name: "Product Feedback from Customers"
